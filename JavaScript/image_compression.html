<!DOCTYPE html>
<html>
<head>
  <title>Image Compression</title>
</head>
<body>
  <input type="file" id="imageInput">
  <img id="previewImage" style="max-width: 300px;">
  <br>
  <button onclick="compressImage()">Compress Image</button>

  <script>
    function compressImage() {
      const imageInput = document.getElementById('imageInput');
      const previewImage = document.getElementById('previewImage');

      if (imageInput.files && imageInput.files[0]) {
        const reader = new FileReader();

        reader.onload = function (e) {
          const img = new Image();

          img.onload = function () {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            // Set the canvas dimensions to the new compressed size
            const maxWidth = 300;
            const maxHeight = 300;
            let newWidth = img.width;
            let newHeight = img.height;

            if (img.width > maxWidth) {
              newWidth = maxWidth;
              newHeight = (img.height * maxWidth) / img.width;
            }

            if (newHeight > maxHeight) {
              newHeight = maxHeight;
              newWidth = (img.width * maxHeight) / img.height;
            }

            canvas.width = newWidth;
            canvas.height = newHeight;

            // Draw the image on the canvas
            ctx.drawImage(img, 0, 0, newWidth, newHeight);

            // Get the compressed data URL (JPEG format)
            const compressedDataURL = canvas.toDataURL('image/jpeg', 0.7); // 0.7 is the quality, 0.0 (worst) to 1.0 (best)

            // Set the compressed image as the preview
            previewImage.src = compressedDataURL;
          };

          img.src = e.target.result;
        };

        reader.readAsDataURL(imageInput.files[0]);
      }
    }
  </script>
</body>
</html>
